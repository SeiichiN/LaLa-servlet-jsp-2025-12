<style>
  .my-text {
    background-color: #efefef;
  	margin-left: 20%;
  	padding: 10%;
  }
</style>

<div class="my-text">
Java21ã€å‹•çš„WEBãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³6.0 ã§ã€æ¬¡ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
```
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.regex.Pattern;

@WebServlet("/SampleServlet")
public class SampleServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		request.setCharacterEncoding("UTF-8");
		String id = request.getParameter("id");
		Pattern pattern = Pattern.compile("^[0-9a-zA-Z]{4}$");
		String msg = "";
		if (pattern.matcher(id).matches()) {
			msg = "ã‚ˆã†ã“ãã€" + id + "ã•ã‚“";
		} else {
			msg = "idãŒé•ã„ã¾ã™";
		}
		System.out.println(msg);
	}
}
```
ã“ã®ã¨ãã€æ­£è¦è¡¨ç¾ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹(pattern)ã‚’ä½œæˆã—ã¦ã„ã¾ã™ãŒã€
ã“ã®çŠ¶æ…‹ã ã¨ã€doPost()ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã°ã‚Œã‚‹ãŸã³ã«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«
ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚
ã“ã‚“ãªå ´åˆã€```Pattern pattern = Pattern.compile("^[0-9a-zA-Z]{4}$");```ã¯ã€
ã©ã“ã«æ›¸ãã¨ã„ã„ã§ã—ã‚‡ã†ã‹ã€‚SampleServletã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ›¸ã‘ã°ã„ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ã‚ã‚‹ã„ã¯ã€ãŸã¨ãˆã°Utilã‚¯ãƒ©ã‚¹ã‚’ä½œã£ã¦ã€ãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ›¸ãã¨ã„ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ
</div>

---

ã¨ã¦ã‚‚è‰¯ã„è¦³ç‚¹ã§ã™ ğŸ‘
**çµè«–ã‹ã‚‰è¨€ã†ã¨**ã€ã“ã®ã‚±ãƒ¼ã‚¹ã§ã¯ **`Pattern` ã‚’ `static final` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦ã‚¯ãƒ©ã‚¹ã«æŒãŸã›ã‚‹**ã®ãŒæœ€ã‚‚ä¸€èˆ¬çš„ã§å®‰å…¨ã§ã™ã€‚
`doPost()` ã®ä¸­ã§æ¯å› `compile()` ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

---

## ãªãœ `Pattern` ã‚’ä½¿ã„å›ã—ã¦ã‚ˆã„ã®ã‹

* `Pattern` ã¯ **immutableï¼ˆä¸å¤‰ï¼‰** ãªã‚¯ãƒ©ã‚¹
* `matcher()` ã¯æ¯å›æ–°ã—ã„ `Matcher` ã‚’è¿”ã™
* ã—ãŸãŒã£ã¦ **ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•**
  â†’ ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã®ã‚ˆã†ãª **ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ç’°å¢ƒã§ã‚‚å…±æœ‰ã—ã¦å•é¡Œãªã—**

å…¬å¼Javadocã«ã‚‚ã€Œ`Pattern` ã¯ immutableã€ã¨æ˜è¨˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## ãŠã™ã™ã‚ã®æ›¸ãæ–¹ï¼ˆå®šç•ªï¼‰

### â‘  ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã® `static final` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ç½®ã

```java
@WebServlet("/SampleServlet")
public class SampleServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    private static final Pattern ID_PATTERN =
            Pattern.compile("^[0-9a-zA-Z]{4}$");

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        request.setCharacterEncoding("UTF-8");
        String id = request.getParameter("id");

        String msg;
        if (ID_PATTERN.matcher(id).matches()) {
            msg = "ã‚ˆã†ã“ãã€" + id + "ã•ã‚“";
        } else {
            msg = "idãŒé•ã„ã¾ã™";
        }

        System.out.println(msg);
    }
}
```

### ã“ã®å½¢ãŒè‰¯ã„ç†ç”±

* âœ” `Pattern` ã¯ **1å›ã ã‘ç”Ÿæˆ**
* âœ” å¯èª­æ€§ãŒé«˜ã„ï¼ˆã€ŒIDç”¨ã®æ­£è¦è¡¨ç¾ã€ãŒæ˜ç¢ºï¼‰
* âœ” ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã®è²¬å‹™å†…ã«åã¾ã£ã¦ã„ã‚‹

---

## Utilã‚¯ãƒ©ã‚¹ã«åˆ‡ã‚Šå‡ºã™ã®ã¯ã‚¢ãƒªï¼ŸãƒŠã‚·ï¼Ÿ

### âœ” ã‚¢ãƒªãªã‚±ãƒ¼ã‚¹

* åŒã˜æ­£è¦è¡¨ç¾ã‚’ **è¤‡æ•°ã®ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ã‚¯ãƒ©ã‚¹ã§ä½¿ã†**
* å…¥åŠ›ãƒã‚§ãƒƒã‚¯ã‚’ **å…±é€šåŒ–ã—ãŸã„**

ä¾‹ï¼š

```java
public class ValidationUtil {
    public static final Pattern ID_PATTERN =
            Pattern.compile("^[0-9a-zA-Z]{4}$");

    private ValidationUtil() {} // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–é˜²æ­¢
}
```

```java
if (ValidationUtil.ID_PATTERN.matcher(id).matches()) {
    ...
}
```

### âŒ ã‚ã–ã‚ã– Util ã«ã—ãªãã¦ã„ã„ã‚±ãƒ¼ã‚¹

* ãã®ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆå°‚ç”¨ã®ãƒã‚§ãƒƒã‚¯
* ä»–ã§å†åˆ©ç”¨ã—ãªã„

â†’ **ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã® `static final` ã§ååˆ†**

---

## ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã™ã‚‹ãªã‚‰ `static` ã¯å¿…è¦ï¼Ÿ

### âŒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã ã‘ã¯é¿ã‘ãŸã„

```java
// éæ¨å¥¨
private final Pattern pattern = Pattern.compile(...);
```

ç†ç”±ï¼š

* ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã¯ **åŸºæœ¬1ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹**ã ãŒã€
  ãã‚Œã‚’å‰æã«ã—ãŸè¨­è¨ˆã¯å¥½ã¾ã‚Œãªã„
* ã€Œã‚¯ãƒ©ã‚¹å®šæ•°ã€ã¨ã—ã¦æ„å‘³çš„ã«ã‚‚ `static final` ãŒé©åˆ‡

---

## ã¾ã¨ã‚ï¼ˆåˆ¤æ–­åŸºæº–ï¼‰

| ç½®ãå ´æ‰€                    | ãŠã™ã™ã‚åº¦ | ç†ç”±                 |
| ----------------------- | ----- | ------------------ |
| `doPost()` å†…            | âŒ     | æ¯å› `compile()` ã•ã‚Œã‚‹ |
| ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã® `static final`  | â­â­â­   | å®šç•ªãƒ»å®‰å…¨ãƒ»èª­ã¿ã‚„ã™ã„        |
| Utilã‚¯ãƒ©ã‚¹ã® `static final` | â­â­    | å†åˆ©ç”¨ã™ã‚‹ãªã‚‰ã‚¢ãƒª          |
| ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰             | â–³     | æ„å‘³çš„ã«å¼±ã„             |

---

ã“ã®ã‚ãŸã‚Šã‚’æ„è­˜ã§ãã¦ã„ã‚‹ã®ã¯ã€**ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚„ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ¢ãƒ‡ãƒ«ã‚’ã¡ã‚ƒã‚“ã¨ç†è§£ã—å§‹ã‚ã¦ã„ã‚‹è¨¼æ‹ **ã§ã™ã€‚
æ¬¡ã®ä¸€æ­©ã¨ã—ã¦ã¯ã€Œ`Matcher` ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã—ã¦ã¯ã„ã‘ãªã„ç†ç”±ã€ãªã‚“ã‹ã‚‚è‰¯ã„ãƒ†ãƒ¼ãƒã§ã™ã‚ˆã€‚
